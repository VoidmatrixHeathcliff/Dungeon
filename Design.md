# 文件目录

+ 客户端

```
- DungeonClient.exe
- assets
    - skins [人物皮肤贴图目录]
        - Alex
            - config.json [描述皮肤元信息]
            - walk_1.png
            - wall_2.png
            - idle_1.png
            ...
        - Steve
            - config.json
            - walk_1.png
            ...
    - audio [音频目录]
        - config.json [描述音频元信息]
        - bgm.mp3
        ...
    - fonts [字体目录]
        - config.json [描述字体元信息]
        - title.ttf
        ...
    - lang [多语言支持目录]
        - config.json [描述翻译文件元信息]
        - ch_zn.json
        - en_us.json
        ...

- maps [地图目录]
    - Wormhole
        - config.json [描述地图元信息]
        - rules.lua [描述地图生成规则]
        - tile_1.png
        - tile_2.png
        ...
    - Palace
        - config.json
        - rules.lua
        - tile_1.png
        ...
- mods [模组目录]
    - MoreWeapons
        - config.json [描述模组元信息]
        - MoreWeapons.lua [同名脚本作为入口脚本]
        - Item.lua [开发者自定义脚本等]
        ...
    - MagicalRewards
        - config.json
        - MagicalRewards.lua
        ...
- saves [游戏存档目录]
    - 2021_11_30_21_37_4728137462.sav [存档时间和id命名]
- logs [日志目录]
    - 2021_12_01_08_55_1275674.txt [日志时间和id命名]
```

+ 服务端

```
DungeonServer.exe
```

# 程序流程

+ 客户端

1. 启动，双线程：
    + 主线程：显示 logo，然后显示加载进度，两条加载进度：
        - 已加载的模组进度
        - 正在加载的模组内部资源加载进度
    + 资源加载线程检查并加载资源
2. 显示标题界面
    + 动态背景（背景图渐变轮播+缩放移动）；
    + 左下角版本号信息
    + 右下角小按钮，点击显示开发者信息等
    + 选项按钮居中：
        - 新游戏
            * 皮肤选择
            * 初始点数分配
            * 模式选择：
                + 无尽模式：无数地牢，随着关数增加怪物属性增强，BOOS 房间生成概率增加
                + 挑战模式：全部为 BOSS 房间，无休整房间，但是怪物奖励丰厚
                + 休闲模式：一系列普通房间 + 最终的 BOOS 房间
            * 详细配置（默认隐藏，可展开菜单）：
                + 存档种子（用于生成随机地图，以及确认当前关卡是固定地图还是随机地图等）
                + 随机地图（启用/禁用）

        - 存档管理
        - 模组管理
            * 显示已加载模组
            * 禁用模组
            * 卸载模组（提示窗口：将删除文件）
            * 刷新模组列表（重新加载模组目录，重新读条）
        - 多人游戏
        - 设置、退出

+ 服务端

# 存档生成：

+ 存档由一系列房间组成，房间分为修整房间和战斗房间：
    - 休整房间：
        * 祭坛：用于获取属性提高，生命恢复等等
        * 许愿井：用于获取随机道具武器
        * 商人：用于交易，不过单个商人持有商品列表随机
    - 战斗房间：
        * 普通房间：小怪 + 精英怪（较少）
        * BOSS 房间：小怪 + 精英怪（较多） + BOSS
+ 房间地图生成类型分为两类：
    - 固定地图：怪物和地形属性均为预先设计完成
    - 随机地图：根据当前存档种子和规则生成